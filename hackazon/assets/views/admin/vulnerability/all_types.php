<?php
$formHelper = $view['form'];
$formHelper->setTheme($form, __DIR__);
/** @var \Symfony\Component\Form\FormView $form */

$allVulns = [];
?>

<?php foreach ($form['vulnerabilities']->children as $child) {
    $vulnHtml = $formHelper->row($child);
    $vulnHtml = str_replace(
        ['form___ALL_VULNS__', 'form[__ALL_VULNS__]'],
        ['{{ id }}', '{{ name }}'],
        $vulnHtml);
    $allVulns[] = $child['name']->vars['value'];
?>
<script type="text/x-handlebars" charset="UTF-8" id="tplVulnerability_<?php echo $child['name']->vars['value']; ?>"
    class="js-template js-vulnerability-template" data-vulnerability="<?php echo $child['name']->vars['value']; ?>">
    <?php echo $vulnHtml."\n"; ?>
</script>
<?php } ?>
<script type="text/javascript">
    VulnInfo = typeof VulnInfo == 'object' ? VulnInfo : {};
    VulnInfo.vulns = ['<?php echo implode("', '", $allVulns) ?>'];
</script>


<?php //echo $formHelper->rest($form); ?>
<?php foreach ($form as $child): ?>
    <?php if (!$child->isRendered()): ?>
        <?php echo $view['form']->row($child) ?>
    <?php endif; ?>
<?php endforeach; ?>

