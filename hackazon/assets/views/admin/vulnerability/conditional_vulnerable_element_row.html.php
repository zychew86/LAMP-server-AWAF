<?php
$formHelper = $view['form'];
$formHelper->setTheme($form, __DIR__);
/** @var \Symfony\Component\Form\FormView $form */
?>
<div class="panel panel-yellow vulnerability-block js-vulnerability-block"
    <?php echo $view['form']->block($form, 'widget_container_attributes') ?>
    data-id="<?php echo $form->vars['id']; ?>" data-name="<?php echo $form->vars['full_name']; ?>">
    <div class="panel-heading form-inline">
        Vulnerabilities <?php echo $view['form']->widget($form['name']); ?>
        <?php echo $form->vars['edit_mode_enabled'] ? '' : ($form['name']->vars['value'] ? ' (' . $form['name']->vars['value'] . ')' : ''); ?>
        <?php if ($form->vars['edit_mode_enabled']): ?>
            <?php if (isset($form['conditionSet'])) {  ?>
                <a href="#" class="js-show-conditions">Hide conditions</a>
            <?php } ?>
            <div class="pull-right">
                <div class="btn-group">
                    <button class="btn btn-default btn-sm js-add-vulnerability-selector dropdown-toggle" data-toggle="dropdown"
                            type="button">Add Vulnerability <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                    </ul>
                </div>
                <div class="btn-group">
                    <?php if (isset($form['conditionSet'])) {  ?>
                        <button class="btn btn-default btn-sm js-add-condition-selector dropdown-toggle" data-toggle="dropdown"
                                type="button">Add Condition <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                        </ul>
                    <?php } ?>
                </div>
                <div class="btn-group">
                    <button class="btn btn-default btn-sm js-add-child" type="button">Add Child</button>
                    <button class="btn btn-default btn-sm js-remove" type="button">Remove</button>
                </div>
            </div>
        <?php endif; ?>
    </div>
    <!-- /.panel-heading -->
    <div class="panel-body">
        <?php
        echo $view['form']->errors($form);

        if (isset($form['conditionSet'])) {  ?>
            <div class="panel panel-yellow vulnerability-conditions-block">
                <div class="panel-body">
                    <?php
                    echo $view['form']->label($form['conditionSet']);
                    echo $view['form']->errors($form['conditionSet']);
                    echo $view['form']->widget($form['conditionSet']);  ?>
                </div>
            </div>
            <?php
        }

        echo $view['form']->label($form['vulnerabilitySet']);
        echo $view['form']->errors($form['vulnerabilitySet']);
        echo $view['form']->widget($form['vulnerabilitySet']);?>

        <?php
        if ($form['children'] && $form['children']->count()) {
            echo $view['form']->row($form['children']);
        }

        echo $view['form']->rest($form); ?>

    </div>
</div>
